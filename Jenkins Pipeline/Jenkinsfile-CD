@Library('github.com/ranjitaws2020/java-shared-library@pipeline') _

pipeline {
    agent any
     environment {
        azcon = credentials('az_sp')
      }
    stages {
        stage('Infra Provisioning') {
           steps {
                Infra()
           }
        }
        stage('Fetch Public IP') {
            steps {
                     FetchPublicIPOfVM()
                
            }
        }
        stage('Download Artifact Form Nexus') {
              steps {
                DownloadFromNexus()
              }
        }
        stage('DeployToTomcat') {   
              steps{
                withCredentials([usernamePassword(credentialsId: 'vm-creds', passwordVariable: 'password', usernameVariable: 'username')]) {
                DeployToTomcat(username, password)
               }
               }
       }
    }
}
