@Library('shared-library') _

pipeline {
   agent any
   environment {
    azcon = credentials('azure-pasha')
   }
  
   
   stages {   
   
   stage('Infra Provisioning') {
     steps {
       Infra()
     }
   }
   
  //stage('Store Public Ip') {
  //   steps {
    //   FetchPublicIP()
   //   }
  //  }
    
   stage('Download Artifact Form Nexus') {
      steps {
        DownloadFromNexus()
      }
      }
 // stage('DeployToTomcat') {   
   ////   steps{
       //withCredentials([usernamePassword(credentialsId: 'vm-creds', passwordVariable: 'password', usernameVariable: 'username')]) {
     //   DeployToTomcat(username, password)
//}
  //}
   // }
   stage('Building Docker Image'){
      steps {
     sh "docker build -t javatomcat:${BUILD_NUMBER} ."
  }
  }
   stage('Deploy To Tomcat COntainer') {
      steps {
        DeployToTomcatContainer()
        cleanWs()
      }
      } 
  }  
  }
